~~~
status: Final
submit: 26 May 2024
dialog: https://github.com/stellar/stellar-docs/issues/1545
~~~

Hi Johan,

Based on limited investigation, [your implementation](https://github.com/future-tense/stellar-pathfinder-server) might just be the first custom pathfinding implementation. Pathfinding matters a lot in the traditional financial system‚Äîwhich perhaps you've seen firsthand with extractive conversion rates. Access to exchanges themselves is one main reason I‚Äôve found increasing costs through middlemen over the years.

That‚Äôs the easy explanation: nobody can directly transact with each other sans brokers. But pathfinding is the more sinister hidden evil corrupting Wall Street and others. Given its significance and common misunderstandings, I‚Äôd sincerely appreciate your help continuing [past efforts](https://wooten.link/liquidity). üíú

## Existing Limitations

I approach pathfinding from the perspective of traditional stock-market order routing. This is a [really big problem](https://youtu.be/bP74RBTE8kI?t=406).[^int] What we have with the DEX stands as the only option distributed as a truly free market.

The root of problems across markets comes from [capitalist competition](https://dx.doi.org/10.1017/S0022109019000814) for a public good and natural monopoly. The referenced study extensively finds that a single market for the stocks of the world would yield at least 20% lower effective spreads than a duopoly. Americans are all too familiar with two prominent competing firms, but much of the same can be said about private exchanges extracting rents abroad.

I really appreciated your help understanding the DEX [last year](https://discord.com/channels/897514728459468821/907476473739354153/1273108124194050140). There‚Äôs no one I can think of across the ecosystem more adept at explaining the existing pathfinding than yourself. üíú I know we saw some misunderstandings about the existing pathfinding in discussions at the end of last year in Global and a liquidity-incentive server, so how about helping clear things up for everyone?

## Present Confusion

I regularly exchange with the government. Representatives and team leads sit at a crucial policy crossroads between centralized and decentralized exchange. We have a limited window to sway them towards the option that provides everyone with the freedom to access markets.

The core of existing routing happens through financial middlemen, as we know. These legacy for-profit firms can make money skimming off trades. Sometimes we see this as trading fees, and other times it's much more complicated.

One obvious conflict can be front-running, which we‚Äôve seen abundantly on other chains. Briefly, this has always been a problem on Wall Street. And it‚Äôs still extracting wealth thanks to the insane complexity of exchange infrastructure.

### Existing Regulations

The top American market maker is opening a new stock exchange just so they can make more money. This works because of nonstandard trade routing. By having more venues connected to their fiber-optic cables, the assholes can fuck you over nanoseconds faster.

The system is so bloated that the present regulations globally just can‚Äôt protect users from this exploitation. The governance is so difficult that the only choice is to leave everyone‚Äôs portfolios teetering on the trust of a select few enterprises‚Äîconglomerates with the same institutional interests who took everything from us when Nakamoto started up.

But here in Core, we have a solution which doesn‚Äôt serve the Rothschilds. A framework which favors efficiency, egalitarianism, and excellence at the highest technical standards. And, quite differently from even other ‚Äúdecentralized exchanges,‚Äù it‚Äôs a model poised to finally take away their choking reins.

### Profit Center

Trust, especially in the SCP context, is super nuanced. Without proper safeguards, we risk centralization at the social layer. Now, imagine that quandary scaled to infinity for an established routing system.

That‚Äôs what Apes saw in 2021 when one agency disabled stock trading. This Establishment handled order routing for hundreds of brokers with more users than existing network accounts. In later Congressional investigation, they received no disciplinary action.

The exchange of one asset to another is so simple. Yet it‚Äôs the first place many companies exploit to profit off their customers. We are all too conditioned into paying fees which fundamentally conflict with using path payments everywhere.

### Unbreaking Horizon

We can overcome our challenges paying for everyday items with real-world assets. üß† To make this happen, we‚Äôll need Stellar protocol routing. This pathfinding holds the key to unlocking liquidity in the DEX.

I love everything about Horizon. It's bizarre to me that major blockchains don't have canonical API implementations. Briefly, I'm not a massive tech guy.[^xc]

But when I learned about APIs my first year of college, a whole new world of development opportunities unfolded right in front of my eyes. It was finally possible to build really interconnected things by using the open interfaces pioneered by dedicated engineers. I feel we have a unique opportunity to do the same, bringing masses of new energies into the network by offering permissionless, quality information about the incredible protocol.

## Collaboration Opportunity

I've been working on the DEX and liquidity pool documentation page for a few months. In fleshing out the interfacing examples, it's become abundantly apparent that the present documentation does not explain core pathfinding. I find this problematic because the select few who understand these routing nuances wind up creating blocks full of failed swaps while they wastefully send circular conversions to themselves for an excess 1,500 stroops.

In [discussion](https://discord.com/channels/897514728459468821/966788672164855829/1372112718948995134), @rahimklaber comments that "they made some changes to core to filter out some of the arb transactions. But a lot still go through" as notably protold by Orbit during the revolutionary Protocol 18 upgrades.

It is not clear what changes have been made over the years to get us to `ExchangeV3`, even if someone reads all the CAPs and community posts about fixes. _See_ your own exceptional [past work](https://github.com/stellar/stellar-protocol/issues/36#issuecomment-396448926) cleaning up DEX certainty as just one example of something every network user has to appreciate today.[^jed] While it might not look like much, non-IEIF orders literally created [our entire industry](https://www.reddit.com/r/Superstonk/comments/12fj2d7/naked_short_and_greedy_wall_streets_failure_to).

Given your experience, would you be ever so kind as to consider adding a page for pathfinding? At the risk of oversimplifying things, you can just create a new file with your thoughts like in #1496. In past discussions, it's become clear to me that you have such a unique ability to explain complex topics succinctly, and I can think of no more hazy topic throughout the developers' site which urgently needs new clarification.[^terminus]


[^int]: While this video focuses on the American market where I work, the problem is just as bad everywhere else on the planet. And for the countries not fortunate enough to have a central stock exchange, we see the horrific effects of malinvestment and unfunded innovation. I think it'd be cool if the whole world was on the same playing field when it comes to entrepreneurial creativity, the core tenet of a marketplace for capital.

[^xc]: I remember trying to learn HTML and CSS in high school through online courses. I was so bad at it that I'd stare at coding screens for hours just to get simple headings to render. And don't even get me started on the number of hours I've spent troubleshooting Truffle, literally just to compile code.

[^jed]: Notably, Jed suggests offloading order book cleanup to service providers processing information updates which are "expensive to prevent." We have seen this same argument made for native pathfinding, and I would suggest community members contemplating routing services ask themselves what might happen to the remarkable existing liquidity if all users had to use "StellarBroker.com" Inc. I love the debiting DEX stability we [uniquely](https://github.com/XRPLF/rippled/issues/1257) enjoy.

[^terminus]: _See, e.g.,_ how Tyler [believes](https://youtu.be/KzlSgSPStz8?t=164) "path payments to be one of the most interesting and important aspects of the Stellar blockchain." Even your own past work with Stargazer dove into the details at a level uncommon throughout network applications. üöÄ _See also_ the core team [referencing](https://groups.google.com/g/stellar-dev/c/zks0oi4v-7g/m/sbw5vtstCwAJ) path payments as a means to implement FoK orders common in institutional adoptions of market-making algorithms.
